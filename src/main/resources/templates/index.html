<!DOCTYPE html>
<html lang="en">
<head>
    <title>Live Events with SSE & WebFlux</title>
    <script>
        function startSSE() {
            const eventSource = new EventSource("/stream-transactions");

            eventSource.onmessage = function(event) {
                const eventList = document.getElementById("event-list");
                const newEvent = document.createElement("li");
                newEvent.textContent = event.data;
                eventList.prepend(newEvent);
            };

            eventSource.onerror = function() {
                console.log("SSE connection lost. Retrying...");
                setTimeout(() => {
                    eventSource.close();
                    startSSE();
                }, 5000);
            };
        }
        window.onload = startSSE;
    </script>
</head>
<body>
<h2>Live Event Stream</h2>
<ul id="event-list"></ul>

</body>
</html>